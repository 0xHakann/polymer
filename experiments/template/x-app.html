<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="x-count.html">
<link rel="import" href="x-template.html">

<style>

  x-app {
    display: block;
  }

  x-app #stuff > div {
    padding: 10px;
    margin: 10px;
    border: 1px solid black;
  }

  x-app li[selected] {
    background-color: green;
  }

</style>
<template>
  <x-count count="{{count}}"></x-count>
  <h2>Below is a template, stamping!</h2>

  <template id="template" is="x-template" model="{{templateModel}}">
    <section id="stuff" Xon-click="clickAction">
      <x-count count="{{count}}"></x-count>      
      <div>{{from}}</div>
      <div>{{message}}</div>
      <div>{{timestamp}}</div>
      <hr>
    </section>
  </template>

  <h2>Above is a template, stamping!</h2>

</template>
<script>
  Polymer({

    name: 'x-app',

    from: 'Hi!',
    message: 'ijfe',

    beforeCreated: function() {
      // TODO(sorvell): file template stamping bug
      // http://jsbin.com/xaludufemi/1/edit
      var sub = this._template.content.querySelector('template');
      this._ref = document.createDocumentFragment();
      while (sub.content.firstChild) {
        this._ref.appendChild(sub.content.firstChild);
      }
    },

    created: function() {
      this.count = 1;
      this.templateModel = this;
    },

    restamp: function() {
      var self = this;
      this.templateModel = {
        from: 'Hi!',
        message: 'ijfm!',
        timestamp: new Date().toLocaleTimeString(),
        clickAction: function(e) {
          self.restamp();
        }
      };
    },

    clickAction: function() {
      this.restamp();
    }

  });

</script>