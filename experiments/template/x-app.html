<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="x-count.html">
<link rel="import" href="x-template.html">

<style>

  x-app {
    display: block;
  }

  x-app #stuff > div {
    padding: 10px;
    margin: 10px;
    border: 1px solid black;
  }

  x-app li[selected] {
    background-color: green;
  }

</style>

<template id="my-template" is="x-template">
  <section id="stuff">
    <x-count count="{{count}}"></x-count>      
    <div on-click="fromClick">{{from}}</div>
    <div>{{message}}</div>
    <div>{{timestamp}}</div>
    <hr>
  </section>
</template>


<template>
  <x-count count="{{count}}"></x-count>
  <h2>Below is a template, stamping!</h2>
  <button on-click="toggleModel">Toggle Model</button>
  <template ref="my-template" is="x-template" model="{{templateModel}}"></template>

  <h2>Above is a template, stamping!</h2>

</template>
<script>
(function() {

  var otherModel = {
    count: 55,
    from: 'New Model',
    message: 'ijfm',
    timestamp: new Date().toLocaleTimeString(),
  };

  Polymer({

    name: 'x-app',

    from: 'Hi!',
    message: 'ijfe',
    timestamp: new Date().toLocaleTimeString(),

    beforeCreated: function() {
      // TODO(sorvell): file template stamping bug
      // http://jsbin.com/xaludufemi/1/edit
      // var sub = this._template.content.querySelector('template');
      // this._ref = document.createDocumentFragment();
      // while (sub.content.firstChild) {
      //   this._ref.appendChild(sub.content.firstChild);
      // }
    },

    created: function() {
      this.count = 1;
      this.templateModel = this;
    },

    toggleModel: function() {
      if (this.templateModel !== this) {
        this.templateModel = this;
      } else {
        this.templateModel = otherModel;
      }
    },

    fromClick: function() {
      console.log('fromClick!');
    }

  });

})();
</script>