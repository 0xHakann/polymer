<link rel="import" href="../../../polymer/polymer.html">
<link rel="import" href="../../../polymer/elements/elements.html">

<style>

  x-app {
    display: block;
    background-color: lightblue;
  }

  x-app [drawer] {
    background-color: #ddd;
  }

  x-app [panel] {
    margin: 64px auto 64px auto;
    width: 500px;
    /*max-width: 700px;*/
    box-shadow: 0px 1px 7px 2px rgba(81,81,81,0.1);
    height: 600px;
    background-color: white;
    padding: 24px;
    position: relative;
  }

  x-app #main {
    position: relative;
  }

  x-app #scroller {
  }

  x-app #toolbar {
    position: absolute;
    top: 0;
    left: 0;
    right: 20px;
  }
  
  x-app x-selector item {
    padding: 8px;
    display: block;
    cursor: pointer;
    user-select: none;
  }
  x-app x-selector [selected] {
    background-color: lightblue;
  }

  #tabs paper-ripple {
    padding: 10px;
    text-align: center;
  }

  #tabs paper-ripple[selected] {
    background-color: green;
  }

  #tabs {
    background-color: seagreen;
  }

  #pages paper-ripple {
    font-size: 500px;
  }

</style>
<template>

  <x-selector id="tabs" horizontal layout selectable="paper-ripple">
    <paper-ripple flex>1</paper-ripple>
    <paper-ripple flex>2</paper-ripple>
    <paper-ripple flex>3</paper-ripple>
    <paper-ripple flex>4</paper-ripple>
  </x-selector>
  
  <x-pages id="pages" flex vertical layout>
    <paper-ripple flex vertical center-center layout>1</paper-ripple>
    <paper-ripple flex vertical center-center layout>2</paper-ripple>
    <paper-ripple flex vertical center-center layout>3</paper-ripple>
    <paper-ripple flex vertical center-center layout>4</paper-ripple>
  </x-pages>

</template>
<script>

  Polymer({

    name: 'x-app',

    hostAttributes: 'vertical layout',

    // published attributes feature (look Ma, types!)

    published: {
      selected: Number
    },

    listeners: {
      'tabs.selected': 'tabsSelected'
    },

    tabsSelected: function(e) {
      e.stopPropagation();
      this.selected = e.target.index;
    },

    bind: {
      selected: 'selectedChanged'
    },

    /* manual form */

    selectedChanged: function(selected) {
      this.$.tabs.index = selected;
      this.$.pages.selected = selected;
    },
   
    /* shape of automated form */

    takeAttributes: function() {
      // overwrites `selectedChanged`
      this.initMultiBind();
      Base.takeAttributes.call(this);
    },

    multibind: {
      selected: {
        tabs: 'index',
        pages: 'selected'
      }
    },

    initMultiBind: function() {
      for (var n in this.multibind) {
        // TODO(sjmiles): `nChanged` name is not canonical
        this[n + 'Changed'] = this.multiBindFactory(this.multibind[n]);
      }
    },

    multiBindFactory: function(targets) {
      return function(value) {
        for (var id in targets) {
          this.$[id][targets[id]] = value;
        }
      }
    }

});

</script>