<link rel="import" href="../../../polymer/polymer.html">
<link rel="import" href="../../../elements/elements.html">

<style>

  x-app {
    display: block;
    background-color: lightblue;
  }

  x-app [drawer] {
    background-color: #ddd;
  }

  x-app [panel] {
    margin: 64px auto 64px auto;
    width: 500px;
    /*max-width: 700px;*/
    box-shadow: 0px 1px 7px 2px rgba(81,81,81,0.1);
    height: 600px;
    background-color: white;
    padding: 24px;
    position: relative;
  }

  x-app #main {
    position: relative;
  }

  x-app #scroller {
  }

  x-app #toolbar {
    position: absolute;
    top: 0;
    left: 0;
    right: 20px;
  }
  
  x-app x-selector item {
    padding: 8px;
    display: block;
    cursor: pointer;
    user-select: none;
  }
  x-app x-selector [selected] {
    background-color: lightblue;
  }

  #tabs paper-ripple {
    padding: 10px;
    text-align: center;
  }

  #tabs paper-ripple[selected] {
    background-color: green;
  }

  #tabs {
    background-color: seagreen;
  }

  #pages paper-ripple {
    font-size: 500px;
  }

</style>
<template>

  <x-selector id="tabs" horizontal layout selectable="paper-ripple">
    <paper-ripple flex>1</paper-ripple>
    <paper-ripple flex>2</paper-ripple>
    <paper-ripple flex>3</paper-ripple>
    <paper-ripple flex>4</paper-ripple>
  </x-selector>
  
  <x-pages id="pages" flex vertical layout>
    <paper-ripple flex vertical center-center layout>1</paper-ripple>
    <paper-ripple flex vertical center-center layout>2</paper-ripple>
    <paper-ripple flex vertical center-center layout>3</paper-ripple>
    <paper-ripple flex vertical center-center layout>4</paper-ripple>
  </x-pages>

</template>
<script>

  Polymer({

    name: 'x-app',

    hostAttributes: 'vertical layout',

    listeners: {
      'tabs.selected': 'tabsSelected'
    },

    bind: {
    },

    /* published attributes feature (look Ma, types!) */

    published: {
      selected: Number
    },

    takeAttributes: function() {
      this.multiBind();
      Base.takeAttributes.call(this);
    },

    /* multi-bind feature */

    multiBind: function() {
      this.selectipants = {
        index: this.$.tabs,
        selected: this.$.pages,
        //selected: this
      };
    },

    get selected() {
      return this._selected;
    },

    set selected(selected) {
      this._selected = selected;
      this.selectedSignal(this, this.selected);
    },

    selectedSignal: function(sender, value) {
      for (var n in this.selectipants) {
        var p = this.selectipants[n];
        if (p !== sender) {
          p[n] = value;
        }
      }
      if (p != this) {
        this.fire('selected');
      }
    },

    // TODO(sjmiles): we'd have to canonicalize this somehow
    tabsSelected: function(e) {
      e.stopPropagation();
      this.selectedSignal(e.target, e.target.index);
    },

    /**/

    selectedChanged: function(selected) {
      // maybe do something
    }

});

</script>