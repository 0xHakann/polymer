<script>

  Polymer.plugins.selectable = {

    bind: {
      'selected': 'selectedChanged'
    },

    initPlugin: function() {
      this.attributeChanged('selectable');
    },

    // TODO(sorvell): bad for a plugin to implement this
    attributeChanged: function(n) {
      switch(n) {
        case 'selectable':
          this.selectable = this.getAttribute(n) || '*';
          break;
      }
    },

    selectedChanged: function(selected, old) {
      if (old) {
        old.removeAttribute('selected');
      } 
      if (selected) {
        selected.setAttribute('selected', '');
      }
    },

    // TODO(sorvell): requires notification if items changes
    get items() {
      if (!this._items) {
        this._items = 
          Array.prototype.slice.call(this.querySelectorAll(this.selectable), 0)
      }
      return this._items;
    },

    get index() {
      return this.items.indexOf(this.selected);
    },

    set index(index) {
      var element = this.items[index];
      if (element) {
        this.selected = element;
      }
    }
  };

</script>
