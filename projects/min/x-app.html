<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../../polymer/elements/elements.html">

<style>

  x-app {
    display: block;
    background-color: lightblue;
  }

  x-app [drawer] {
    background-color: #ddd;
  }

  x-app [panel] {
    margin: 64px auto 64px auto;
    width: 500px;
    /*max-width: 700px;*/
    box-shadow: 0px 1px 7px 2px rgba(81,81,81,0.1);
    height: 600px;
    background-color: white;
    padding: 24px;
    position: relative;
  }

  x-app #main {
    position: relative;
  }

  x-app #scroller {
  }

  x-app #toolbar {
    position: absolute;
    top: 0;
    left: 0;
    right: 20px;
  }
  
  x-app x-selector item {
    padding: 8px;
    display: block;
    cursor: pointer;
    user-select: none;
  }
  x-app x-selector [selected] {
    background-color: lightblue;
  }

  #tabs paper-ripple {
    padding: 10px;
    text-align: center;
  }

  #tabs paper-ripple[selected] {
    background-color: green;
  }

  #tabs {
    background-color: seagreen;
  }

  #pages paper-ripple {
    font-size: 500px;
  }

</style>
<template>

  <x-selector id="tabs" horizontal layout selectable="paper-ripple" Xselected="{{selected}}" Xon-selected="tabsSelected">
    <paper-ripple flex>1</paper-ripple>
    <paper-ripple flex>2</paper-ripple>
    <paper-ripple flex>3</paper-ripple>
    <paper-ripple flex>4</paper-ripple>
  </x-selector>
  <x-pages id="pages" flex vertical layout Xselected="{{selected}}">
    <paper-ripple flex vertical center-center layout>1</paper-ripple>
    <paper-ripple flex vertical center-center layout>2</paper-ripple>
    <paper-ripple flex vertical center-center layout>3</paper-ripple>
    <paper-ripple flex vertical center-center layout>4</paper-ripple>
  </x-pages>

</template>
<script>

  Polymer({

    name: 'x-app',

    hostAttributes: 'vertical layout',

    listeners: {
      'tabs.selected': 'tabsSelected'
    },

    bind: {
      selected: 'selectedChanged'
    },

    created: function() {
      this.attributeChanged('selected');
    },

    attributeChanged: function(name) {
      if (name === 'selected') {
        this.selected = Number(this.getAttribute('selected')) || 0;
      }
    },

    selectedChanged: function(selected) {
      this.selectify(this.$.tabs, selected);
      // ok, pages is not a selector
      this.$.pages.selected = selected;
    },

    // selector needs a bit of help
    selectify: function(selector, index) {
      var n = selector.children[index];
      // need no change stop
      if ((selector.selected !== n) && (selector._selected !== n)) {
        selector.selected = n;
      }
    },

    tabsSelected: function(e) {
      var i = Array.prototype.indexOf.call(e.target.children,
        e.target._selected);
      if (!isNaN(i)) {
        this.selected = i;
      }
    }


  });

</script>