<link rel="import" href="pi-feed.html">

<style>

  pi-topic-item > #thumb {
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center;
  }
  pi-topic-item > #info {
    height: 55px;
    padding: 0 8px;
    font-size: 18px;
  }

</style>

<template>

  <div id="thumb" flex></div>
  <div id="info" horizontal center layout>{{item.title}}</div>
  <pi-feed id="feed" topic="{{item}}" on-topic-thumb-change="renderBackground"></pi-feed>

</template>

<script>

Polymer({
  name: 'pi-topic-item',
  hostAttributes: 'vertical inline layout',
  bind: {
    visibility: 'visibilityChanged',
    background: 'backgroundChanged'
  },
  computed: {
    visibility: 'computeVisibility(item)',
    background: 'computeBackground(item)'
  },
  computeVisibility: function(item) {
    return item && Boolean(item.title) ? '' : 'hidden';
  },
  visibilityChanged: function() {
    this.style.visibility = this.visibility;
  },
  computeBackground: function(item) {
    return item && item.thumb && 'url(' + item.thumb + ')';
  },
  backgroundChanged: function() {
    this.$.thumb.style.backgroundImage = this.background;
  },
  renderBackground: function() {
    this.background = this.computeBackground(this.item);
  },
  refresh: function() {
    this.$.feed.populateFeed();
  }
});

</script>
