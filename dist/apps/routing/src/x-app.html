<link rel="import" href="../../../polymer/polymer.html">
<link rel="import" href="../../../polymer/data.html">

<link rel="import" href="../../../elements/elements.html">

<style>

  x-app {
    display: block;
  }

  x-app #pages2 {
    background-color: lightblue;
    margin: 320px;
  }

</style>
<template>

  <x-route id="main" route="{{route}}"></x-route>

  <x-pages id="pages" selected="{{page}}" flex vertical layout on-click="pageClick">

    <paper-ripple flex center-center vertical layout>
      <span>One</span>
    </paper-ripple>

    <paper-ripple flex vertical layout>

      <x-route id="page2"></x-route>

      <x-pages id="pages2" selected="{{page2}}" flex vertical layout on-click="page2Click">
        <paper-ripple flex vertical center-center layout>Two:Bar</paper-ripple>
        <paper-ripple flex vertical center-center layout>Two:Zot</paper-ripple>
      </x-pages>

    </paper-ripple>

    <paper-ripple flex vertical center-center layout>
      Three
      <x-route id="page3"></x-route>
    </paper-ripple>

  </x-pages>

</template>
<script>
  Polymer({

    name: 'x-app',

    hostAttributes: 'vertical layout',
    
    bind: {
      route: 'routeChanged',
      page: 'pageChanged',
      page2: 'page2Changed'
    },

    created: function() {
      var m = this.$.main.route;
      this.page = 0;
      this.page2 = 0;
      this.$.main.setRoute('');
      this.$.main.setRoute(m);
    },

    routeChanged: function(route) {
      console.log('routeChanged: ', route);
      this.page = {'one': 0, 'two': 1, 'three': 2}[route] || 0;
    },

    pageChanged: function(page) {
      console.log('pageChanged: ', page);
      this.$.main.setRoute(['one', 'two', 'three'][page]);
    },

    page2Changed: function(page) {
      console.log('page2Changed: ', page);
      this.$.page2.setRoute(['bar', 'zot'][page]);
    },

    pageClick: function() {
      this.page = (this.page + 1) % 3;
    },

    page2Click: function(e) {
      e.stopPropagation();
      this.page2 = (this.page2 + 1) % 2;
    }

  });

</script>