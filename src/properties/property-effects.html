<!--
@license
Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../utils/utils.html">
<link rel="import" href="property-accessors.html">

<script>
(function() {

  'use strict';
  var PropertyEffects = Object.create(Polymer.PropertyAccessors);

  Polymer.Utils.mixin(PropertyEffects, {

    createReadOnlyProperty: function(model, property) {
      this._ensureAccessor(model, property, true);
    },

    createObserver: function(model, property, methodName, context) {
      this.addPropertyEffect(model, property, {
        fn: this._runObserver,
        info: {
          methodName: methodName,
          context: context || model
        }
      });
    },

    _runObserver: function(property, value, old, info) {
      var fn = info.context[info.methodName];
      if (fn) {
        fn.call(info.context, value, old);
      } else {
        // this._warn(this._logf('_observerEffect', 'observer method `' +
        //   effect.method + '` not defined'));
      }
    }

  });

  // export
  Polymer.PropertyEffects = PropertyEffects;

})();
</script>
