<!--
@license
Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="style-util.html">
<script>

  Polymer.StyleDefaults = (function() {

    var styleProperties = Polymer.StyleProperties;
    var styleUtil = Polymer.StyleUtil;
    
    var api = {

      style: document.createElement('style'),

      _properties: null,

      applyCss: function(cssText) {
        this.style.textContent += cssText;
        this._properties = null;
      },

      get _styleProperties() {
        if (!this._properties) {
          // force rules to reparse since they may be out of date
          this.style.__cssRules =
            styleUtil.parser.parse(this.style.textContent);
          styleProperties.decorateRules(this.style.__cssRules);
          // NOTE: reset cache for own properties; it may have been set when
          // an element in an import applied styles (e.g. custom-style)
          this._styles._ownStyleProperties = null;
          this._properties = styleProperties
            .rootPropertiesFromStyles(this._styles);
        }
        return this._properties;
      }

    };

    api._styles = [api.style];

    api.applyCss('');

    // exports
    return api;

  })();
</script>
