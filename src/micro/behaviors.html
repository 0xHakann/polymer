<!--
@license
Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<script>

  /**
   * Automatically extend using objects referenced in `mixins` array.
   *
   *     Polymer({
   *
   *       mixins: [
   *         someMixinObject
   *       ]
   *
   *       ...
   *
   *     });
   *
   * @class base feature: mixins
   */

  Polymer.Base._addFeature({

    behaviors: [],

    _prepBehaviors: function() {
      this._prepEffects();
      this._prepBehavior(this);
      this.behaviors.forEach(function(b) {
        this._mixinBehavior(b);
        this._prepBehavior(b);
      }, this);
      this._prepBindings();
    },

    _mixinBehavior: function(b) {
      Object.getOwnPropertyNames(b).forEach(function(n) {
        switch (n) {
          case 'accessors':
          case 'listeners':
          case 'keyPresses':
          case 'hostAttributes':
            break;
          default:
            this.copyOwnProperty(n, b, this);
            break;
        }
      }, this);
    },

    _doBehavior: function(name, args) {
      this._invokeBehavior(this);
      this.behaviors.forEach(this._invokeBehavior, this);
    },

    _invokeBehavior: function(b, args) {
      var fn = b[fn];
      if (fn) {
        fn.apply(this, args || Polymer.nar);
      }
    },

    _marshalBehaviors: function() {
      this._marshalBehavior(this);
      this.behaviors.forEach(function(b) {
        this._marshalBehavior(b);
      }, this);
    },

    _marshalBehavior: function(b) {
      this._installHostAttributes(b.hostAttributes);
      this._listenListeners(b.listeners);
      this._listenKeyPresses(b.keyPresses);
    }

  });

</script>
