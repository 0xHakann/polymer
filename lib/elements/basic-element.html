<!--
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../utils/boot.html">
<link rel="import" href="../utils/mixin.html">
<link rel="import" href="../mixins/property-accessors.html">

<script>
(function() {
  'use strict';

  /**
   * Custom element base class that provides minimal starting point
   * using PropertyAccessors to create properties.
   *
   * @customElement
   * @polymer
   * @memberof Polymer
   * @constructor
   * @implements {Polymer_PropertyAccessors}
   * @extends HTMLElement
   * @appliesMixin Polymer.PropertyAccessors
   * @summary Custom element base class that provides minimal starting point
   * using PropertyAccessors to create properties
   */
   class BasicElement extends Polymer.PropertyAccessors(HTMLElement) {

    static _ensureFinalized(name) {
      const proto = this.prototype;
      if (!proto.hasOwnProperty('__finalized')) {
        proto.__finalized = true;
        this.finalize(name);
      }
    }

    static get observedAttributes() {
      const props = this.properties;
      return props ? Object.keys(props) : [];
    }

    /**
     * Finalizes an element definition. This includes ensuring property
     * accessors exist on the element prototype and parsing the element
     * template.
     * @param {string} name Name of the element
     */
    static finalize(name) {
      const props = this.properties;
      if (props) {
        this.prototype.__propertyInfo = props;
        this.createProperties(Object.keys(props));
      }
    }

    /**
     * Overrides default behavior and adds a call to `finalize`.
     * @override
     */
    _initializeProperties() {
      this.constructor._ensureFinalized(this.localName);
      super._initializeProperties();
    }

    _attributeToProperty(attribute, value, type) {
      if (!type) {
        const property = this._propertyNameForAttribute(attribute);
        const props = this.__propertyInfo;
        const info = props && props[property];
        type = info && info.type || info ;
      }
      super._attributeToProperty(attribute, value, type);
    }

    connectedCallback() {
      this._enableProperties();
    }

    /**
     * Called when the element is removed from a document
     */
     disconnectedCallback() {}

   }
  /**
   * @constructor
   * @implements {Polymer_PropertyAccessors}
   * @extends {HTMLElement}
   */
  Polymer.BasicElement = BasicElement;

})();

</script>
