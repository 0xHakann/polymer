<!DOCTYPE html>
<!--
Copyright 2013 The Polymer Authors. All rights reserved.
Use of this source code is governed by a BSD-style
license that can be found in the LICENSE file.
-->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>mdv syntax</title>
  <script src="../../polymer.js"></script>
  <script src="../../tools/test/htmltest.js"></script>
  <script src="../../node_modules/chai/chai.js"></script>
</head>
<body>
  <!-- bind -->
  <element name="mdv-bind" attributes="test">
    <template>
      <template bind="{{test.value as v}}">
      <span id="output">{{v}}</span>
      </template>
    </template>
    <script>
      Polymer.register(this, {
        testbind: function() {
          var o = this.webkitShadowRoot.querySelector('#output');
          chai.assert.equal(o.textContent, this.test.value);
        }
      });
    </script>
  </element>

  <!-- repeat -->
  <element name="mdv-repeat" attributes="test">
    <template>
      <template repeat="{{item in test}}">
        <div>{{item.value}}</div>
      </template>
    </template>
    <script>
      Polymer.register(this, {
        testrepeat: function() {
          var d = this.webkitShadowRoot.querySelectorAll('div');
          for (var i = 0; i < d.length; i++) {
            chai.assert.equal(d[i].textContent, this.test[i].value);
          }
        }
      });
    </script>
  </element>

  <!-- all -->
  <element name="mdv-holder" attributes="testmodel">
    <template>
      <mdv-bind id="bind" test="{{testmodel.bindAs}}"></mdv-bind>
      <mdv-repeat id="repeat" test="{{testmodel.repeatIn}}"></mdv-repeat>
    </template>
    <script>
      Polymer.register(this, {
        inserted: function() {
          this.asyncMethod('runTests');
        },
        runTests: function() {
          this.$.bind.testbind();
          this.$.repeat.testrepeat();
          done();
        }
      });
    </script>
  </element>

  <!-- boot -->
  <script>
    var e = document.createElement('mdv-holder');
    e.testmodel = {
      bindAs: {value: 42},
      repeatIn: [{value: 1}, {value: 2}]
    };
    document.body.appendChild(e);
  </script>

</body>
</html>
