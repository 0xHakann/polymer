<!doctype html>
<!--
@license
Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<html>
<head>
  <title>Polymer - shady</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="../../../webcomponentsjs/webcomponents-lite.js"></script>

  <link rel="import" href="../../src/shady/shady.html">
</head>
<body>

  <template id="v1">
    <div style="padding: 8px; background: #ccc;">
      <header>header (v1)</header>
      <div style="margin: 8px; padding: 8px; background: beige;">
        <slot></slot>
      </div>
      <footer>footer</footer>
    </div>
    <div id="last">last</div>
  </template>
  
  <script>
  HTMLImports.whenReady(function() {

    'use strict';

    var template = document.querySelector('template#v1');

    class XBaseV1 extends HTMLElement {
      
      attachedCallback() {
        if (!this.__stamped) {
          this.__stamped = true;
          this.attachShadow({mode: 'open'}).appendChild(
            document.importNode(template.content, true));
        }
        var d = document.createElement('div');
        d.textContent = 'dynamic';
        this.insertBefore(d, this.firstElementChild);
      }

    }

    document.registerElement('x-base-v1', XBaseV1);

    //Polymer.DomTreeMutation.patch(test);

  });

  </script>

  <template id="v0">
    <div style="padding: 8px; background: #ccc;">
      <header>header (v0)</header>
      <div style="margin: 8px; padding: 8px; background: beige;">
        <content></content>
      </div>
      <footer>footer</footer>
    </div>
  </template>
  
  <script>
  HTMLImports.whenReady(function() {

    'use strict';

    var template = document.querySelector('template#v0');

    class XBaseV0 extends HTMLElement {
      
      attachedCallback() {
        if (!this.__stamped) {
          this.__stamped = true;
          this.createShadowRoot().appendChild(
            document.importNode(template.content, true));
        }
        var d = document.createElement('div');
        d.textContent = 'dynamic';
        this.insertBefore(d, this.firstElementChild);
      }

    }

    document.registerElement('x-base-v0', XBaseV0);

  });

  </script>

  <x-base-v1 id="test">
    <div>light child</div>
  </x-base-v1>

  <br><hr><br>

  <x-base-v0>
    <div>light child</div>
  </x-base-v0>

</body>
</html>
