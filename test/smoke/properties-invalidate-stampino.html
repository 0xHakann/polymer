<!doctype html>
<!--
@license
Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<html>
<head>
  <title>Polymer - properties</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="../../../webcomponentsjs/webcomponents-lite.js"></script>
  <script src="https://cdn.rawgit.com/PolymerLabs/IMD/master/imd.js"></script>
  <script src="https://rawgit.com/justinfagnani/stampino/master/stampino.min.js"></script>
  <link rel="import" href="../../src/attributes/attribute-to-from-property.html">
  <link rel="import" href="../../src/template/template-stamp.html">
  <link rel="import" href="../../src/events/gesture-event-listeners.html">
  <link rel="import" href="../../src/properties/property-accessors.html">
  <link rel="import" href="../../src/properties/batched-effects.html">

</head>
<body>

  <template id="template">
    <div>foo: {{foo}}</div>
    <div>bar: {{bar}}</div>
    <div>concat(foo, bar): {{concat}}</div>
  </template>

  <script>
  (function() {
    'use strict';

    var logEl = window.logEl = function(el) {
      return el.localName + (el.id ? '#' + el.id : '');
    };

    var attributes = new Polymer.AttributeToProperty();
    var accessors = new Polymer.PropertyAccessors();
    var data = new Polymer.BatchedEffects();

    class XTest extends HTMLElement {

      static get observedAttributes() {
        return ['foo', 'bar', 'baz'];
      }

      attributeChangedCallback(name, old, value) {
        attributes.attributeToProperty(this, name, value);
      }

      constructor() {
        super();
        this.dom = new XTestDom();
        this.attachShadow({mode:'open'}).appendChild(data.stamp(template, this.dom));
        data.enablePropertyEffects(this.dom);
      }

      propertiesChanged(props, oldProps, changedProps) {
        this.dom.setProperties({
          foo: props.foo,
          bar: props.bar,
          concat: `${props.foo} ${props.bar}`
        });
      }

    }

    accessors.createAcessorsForAttributes(XTest);

    class XTestDom {};
    data.bindTemplate(XTestDom, template);

    customElements.define('x-test', XTest);

  })();
  </script>

  <x-test id="el1" foo="foo" bar="bar"></x-test>

  <script>

    var logEl = window.logEl;

  </script>

</body>
</html>
